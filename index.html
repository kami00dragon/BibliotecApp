<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BibliotecApp</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            min-height: 100vh;
            background: linear-gradient(to bottom, #fef3c7, #fcd34d);
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            background: linear-gradient(to bottom, #451a03, #78350f, #451a03);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            padding: 2rem 1rem 1rem 1rem;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header-title {
            text-align: center;
            margin-bottom: 1rem;
        }

        .header-title h1 {
            font-size: 2.5rem;
            margin-bottom: 0.25rem;
            font-weight: 900;
            font-family: 'Georgia', serif, sans-serif;
            color: #fcd34d;
            letter-spacing: 2px;
        }

        .header-with-guardians {
            display: flex;
            align-items: flex-end; /* Alinea todo abajo */
            justify-content: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .guardians-container {
            display: flex;
            align-items: flex-end; /* Alinea im谩genes al fondo */
            gap: 0.25rem;
        }

        .guardian-statue {
            width: 7.5rem;
            height: 10.5rem;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.4));
        }

        .guardian-shisa {
            width: 9rem;
            height: 10.5rem;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.4));
        }

        @media (min-width: 768px) {
            .guardian-statue {
                width: 9rem;
                height: 12rem;
            }
            .guardian-shisa {
                width: 11rem;
                height: 12rem;
            }
        }

        @media (max-width: 480px) {
            .header-with-guardians {
                flex-direction: column;
                gap: 0.5rem;
            }
            .guardian-statue {
                width: 6rem;
                height: 8.4rem;
            }
            .guardian-shisa {
                width: 7.2rem;
                height: 8.4rem;
            }
        }

        .search-filters {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            align-items: center;
            margin-top: 0; /* Justo debajo del t铆tulo */
        }

        .search-with-stars {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        .search-star {
            width: 2.5rem;
            height: 2.5rem;
            filter: drop-shadow(2px 2px 4px rgba(0, 0, 0, 0.3));
            flex-shrink: 0;
        }

        .search-input {
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: 2px solid #f59e0b;
            background: white;
            color: #78350f;
            font-size: 1rem;
            width: 100%;
            max-width: 300px;
        }

        .search-input:focus {
            outline: none;
            border-color: #f59e0b;
        }

        .search-input::placeholder {
            color: #b45309;
        }

        .filter-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: #fef3c7;
            cursor: pointer;
            font-size: 1rem;
        }

        .filter-checkbox {
            width: 1.25rem;
            height: 1.25rem;
            accent-color: #f59e0b;
            cursor: pointer;
        }

        /* Main Content */
        main {
            flex: 1;
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
            width: 100%;
        }

        .library-frame {
            position: relative;
            background: linear-gradient(to bottom, #78350f, #451a03);
            border-radius: 1rem;
            padding: 1rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            width: 100%;
        }

        .library-inner {
            position: relative;
            background: linear-gradient(to bottom right, #fef9c3, #fde68a);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: inset 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 100%;
        }

        .library-molding {
            position: absolute;
            left: 0;
            right: 0;
            height: 1rem;
            background: linear-gradient(to bottom, #92400e, #78350f);
        }

        .library-molding.top {
            top: 0;
            border-radius: 0.75rem 0.75rem 0 0;
        }

        .library-molding.bottom {
            bottom: 0;
            border-radius: 0 0 0.75rem 0.75rem;
        }

        /* Bookshelf */
        .bookshelf {
            margin-bottom: 1.5rem;
        }

        .bookshelf-bg {
            background: linear-gradient(to bottom, #92400e, #78350f);
            border-radius: 0.5rem;
            padding: 1.5rem;
            min-height: 200px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }

        .books-container {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 0.25rem;
            min-height: 160px;
            padding-bottom: 0.75rem;
            flex-wrap: wrap;
        }

        /* Alineaci贸n alternativa de estantes */
        .books-container.align-left {
            justify-content: flex-start;
            padding-left: 0.5rem;
        }

        .books-container.align-right {
            justify-content: flex-end;
            padding-right: 0.5rem;
        }

        .shelf-board {
            height: 1.5rem;
            background: linear-gradient(to bottom, #92400e, #78350f);
            border-radius: 0.125rem;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.4);
        }

        /* Book Button */
        .book {
            position: relative;
            width: 2.5rem;
            height: 10rem;
            border-radius: 0.125rem;
            background: #8B4513;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4), inset 1px 1px 2px rgba(255, 255, 255, 0.1);
            transform: translateY(0);
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: hidden;
            border: none;
        }

        .book:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 4px 4px 12px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .book-spine {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0.5rem;
            background: rgba(0, 0, 0, 0.2);
        }

        .book-texture {
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.3), transparent);
        }

        .book-decoration {
            position: absolute;
            left: 0.125rem;
            top: 0.5rem;
            bottom: 0.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .book-line {
            width: 0.25rem;
            height: 0.125rem;
            background: rgba(255, 255, 255, 0.2);
        }

        /* Libros sin URL no tienen etiqueta (estilo simple) */
        .book.no-label {
            /* Opcional: Estilo diferente para libros sin PDF */
            background: linear-gradient(to right, #8B4513, #6d3617);
            opacity: 0.7;
        }

        /* Special Book (Enciclopedia) */
        .special-book {
            position: relative;
            width: 4rem;
            height: 10rem;
            border-radius: 0.125rem;
            box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.4), inset 1px 1px 2px rgba(255, 255, 255, 0.1);
            transform: translateY(0);
            transition: all 0.3s ease;
            cursor: pointer;
            overflow: visible;
            text-decoration: none;
            display: block;
        }

        .special-book:hover {
            transform: translateY(-4px) scale(1.05);
            box-shadow: 4px 4px 12px rgba(0, 0, 0, 0.5);
            z-index: 10;
        }

        .special-book-texture {
            position: absolute;
            inset: 0;
            background: linear-gradient(to right, rgba(0, 0, 0, 0.3), transparent);
        }

        .special-book-decoration {
            position: absolute;
            left: 0.25rem;
            top: 0.5rem;
            bottom: 0.5rem;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .special-book-line {
            width: 0.25rem;
            height: 0.125rem;
            background: rgba(255, 255, 255, 0.2);
        }

        .special-book-label {
            position: absolute;
            right: 0.5rem;
            top: 15%;
            transform: rotate(-180deg);
            font-size: 0.75rem;
            color: white;
            font-weight: bold;
            letter-spacing: 0.1em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
            line-height: 1.2;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            height: 70%;
            overflow: hidden;
        }

        /* Insectos (Bichos) */
        
        /* Mariposa */
        .butterfly {
            position: absolute;
            top: 10px;
            right: -5px;
            width: 24px;
            height: 20px;
            z-index: 20;
            pointer-events: none;
        }

        .butterfly-wing {
            position: absolute;
            top: 0;
            width: 12px;
            height: 18px;
            background: rgba(147, 51, 234, 0.7);
            border-radius: 50% 50% 0 50%;
            animation: flutter 0.15s infinite alternate;
        }
        
        /* Variantes de color */
        .butterfly.blue .butterfly-wing {
            background: rgba(59, 130, 246, 0.7); /* Azul */
        }
        .butterfly.yellow .butterfly-wing {
            background: rgba(234, 179, 8, 0.7); /* Amarillo */
        }

        .butterfly-wing.left {
            left: 0;
            transform-origin: right center;
        }
        .butterfly-wing.right {
            right: 0;
            transform-origin: left center;
            transform: scaleX(-1);
        }
        @keyframes flutter {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(60deg); }
        }

        /* Mariquita (en libro) - Abierta 3D */
        .ladybug-container {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 14px;
            z-index: 20;
            transform-style: preserve-3d;
            perspective: 50px;
        }

        .ladybug-head {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 5px;
            background: black;
            border-radius: 5px;
            z-index: 30;
        }

        /* Alas inferiores */
        .ladybug-wing-under {
            position: absolute;
            top: 2px;
            bottom: 2px;
            width: 40%;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            z-index: 10;
            animation: flutterWings 0.1s infinite alternate;
        }
        .ladybug-wing-under.left { left: 10%; transform-origin: right center; }
        .ladybug-wing-under.right { right: 10%; transform-origin: left center; }

        @keyframes flutterWings {
            0% { transform: rotateY(-10deg); }
            100% { transform: rotateY(10deg); }
        }

        /* Caparach贸n (Alas rojas superiores) */
        .ladybug-shell {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 50%;
            background: radial-gradient(circle at 30% 30%, #ef4444, #b91c1c);
            z-index: 20;
            animation: openShell 1.5s infinite ease-in-out alternate;
        }
        .ladybug-shell.left { 
            left: 0; 
            border-radius: 8px 0 0 0; 
            transform-origin: right center; 
        }
        .ladybug-shell.right { 
            right: 0; 
            border-radius: 0 8px 0 0; 
            transform-origin: left center; 
        }

        /* Manchas caparach贸n */
        .ladybug-spot-shell {
            position: absolute;
            width: 2px;
            height: 2px;
            background: black;
            border-radius: 50%;
        }
        .ls-1 { top: 2px; right: 2px; }
        .ls-2 { top: 5px; right: 4px; }
        .ls-3 { top: 2px; left: 2px; }
        .ls-4 { top: 5px; left: 4px; }

        @keyframes openShell {
            0% { transform: rotateY(0deg); }
            100% { transform: rotateY(-70deg); } 
        }


        /* Mariquita Caminando (en estante) */
        .ladybug-walking {
            position: absolute;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle at 30% 30%, #ef4444, #b91c1c);
            border-radius: 50%;
            z-index: 4;
            box-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .ladybug-walking::before { /* Cabeza */
            content: '';
            position: absolute;
            top: -2px;
            left: 1px;
            width: 5px;
            height: 3px;
            background: black;
            border-radius: 50%;
        }
        .ladybug-walking::after { /* L铆nea */
            content: '';
            position: absolute;
            top: 0;
            left: 50%;
            height: 100%;
            width: 1px;
            background: black;
        }
        .ladybug-walking .spot {
            position: absolute;
            width: 1.5px;
            height: 1.5px;
            background: black;
            border-radius: 50%;
        }
        .lw-s1 { top: 1px; left: 1px; }
        .lw-s2 { top: 5px; left: 1px; }
        .lw-s3 { top: 1px; right: 1px; }
        .lw-s4 { top: 5px; right: 1px; }

        .ladybug-walking-legs {
            position: absolute;
            bottom: -1px;
            left: -1px;
            width: 10px;
            height: 2px;
            background: transparent;
        }
        .ladybug-walking-legs::before, .ladybug-walking-legs::after {
            content: '';
            position: absolute;
            width: 3px;
            height: 2px;
            background: black;
            border-radius: 2px;
        }
        .ladybug-walking-legs::before { left: 1px; animation: leg-move 0.2s infinite; }
        .ladybug-walking-legs::after { right: 1px; animation: leg-move 0.2s infinite reverse; }

        @keyframes leg-move {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(20deg); }
        }


        /* Modal */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.8);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 1rem;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: linear-gradient(to bottom right, #fef9c3, #fef3c7);
            border-radius: 0.5rem;
            max-width: 32rem;
            width: 100%;
            padding: 1.5rem;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 4px solid #78350f;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            gap: 1rem;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #78350f;
            flex: 1;
        }

        .modal-close {
            background: none;
            border: none;
            color: #78350f;
            font-size: 2rem;
            cursor: pointer;
            padding: 0;
            width: 2rem;
            height: 2rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-close:hover {
            color: #dc2626;
        }

        .modal-info {
            margin-bottom: 1.5rem;
        }

        .modal-info p {
            color: #92400e;
            margin-bottom: 0.5rem;
            font-size: 1rem;
        }

        .modal-info strong {
            font-weight: bold;
        }

        .modal-status-available {
            color: #16a34a;
            font-weight: bold;
        }

        .modal-status-unavailable {
            color: #dc2626;
            font-weight: bold;
        }

        .read-pdf-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            background: linear-gradient(to right, #dc2626, #b91c1c);
            color: white;
            padding: 1rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            text-decoration: none;
            margin-top: 1rem;
            transition: all 0.2s ease;
        }

        .read-pdf-btn:hover {
            background: linear-gradient(to right, #b91c1c, #991b1b);
            transform: scale(1.02);
        }

        .no-pdf-message {
            background: #fef3c7;
            border: 2px solid #f59e0b;
            border-radius: 0.5rem;
            padding: 1rem;
            text-align: center;
        }

        .no-pdf-message p {
            color: #78350f;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .no-pdf-message small {
            color: #b45309;
        }

        /* No Results */
        .no-results {
            text-align: center;
            padding: 3rem 1rem;
        }

        .no-results h2 {
            font-size: 1.5rem;
            color: #78350f;
            margin-bottom: 0.5rem;
        }

        .no-results p {
            color: #92400e;
        }

        /* Footer */
        footer {
            background: linear-gradient(to right, #78350f, #92400e, #78350f);
            box-shadow: 0 -4px 6px rgba(0, 0, 0, 0.3);
            padding: 1.5rem;
            margin-top: auto;
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            text-align: center;
        }

        .footer-content p {
            color: #fef3c7;
            margin-bottom: 0.5rem;
        }

        .footer-content small {
            color: #fcd34d;
            font-size: 0.875rem;
        }

        /* Responsive */
        @media (max-width: 640px) {
            .book {
                width: 1.8rem;
                height: 7rem;
            }
            .books-container {
                gap: 0.125rem;
                min-height: 110px;
            }
            .special-book {
                width: 3rem;
                height: 7rem;
            }
            .special-book-label {
                font-size: 0.6rem;
                top: 10%;
            }
            .bookshelf-bg {
                padding: 1rem;
                min-height: 140px;
            }
            .shelf-board {
                height: 1rem;
            }
            .header-title h1 {
                font-size: 1.2rem;
            }
            .modal-content {
                padding: 1rem;
            }
            .modal-title {
                font-size: 1.25rem;
            }
            /* Bichos m谩s peque帽os en m贸viles */
            .butterfly { width: 16px; height: 14px; }
            .ladybug-container { width: 12px; height: 10px; }
        }

        @media (max-width: 768px) {
            header {
                padding: 1.5rem 1rem 0.5rem 1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <div class="header-title">
                <!-- Estructura Header "Antigua" solicitada -->
                <div class="header-with-guardians">
                    <!-- Guardianes Izquierdos: Shisa -->
                    <div class="guardians-container">
                        <!-- Shisa Izquierda -->
                        <img class="guardian-shisa"
                            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRMOuhV-r33EeG4zUxRL3zGHfM4dSlG4YDrTg&s" 
                            alt="Shisa Izquierda" />
                    </div>

                    <!-- Maneki Neko -->
                    <img class="guardian-statue" 
                        src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTxJHUlDF4_7mwDAtfC5hLyENEtVIXyFE4FDg&s" 
                        alt="Maneki Neko" />

                    <h1>BibliotecApp</h1>

                    <!-- Guardianes derechos: Zorro y Shisa (orden invertido) -->
                    <div class="guardians-container">
                        <!-- Zorro de Inari -->
                        <img class="guardian-statue" 
                            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR8AyBlti_G6jkGC1lKWl3dNU1aqPrQyryoxg&s" 
                            alt="Zorro Kitsune" />

                        <!-- Shisa Derecha -->
                        <img class="guardian-shisa" 
                            src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQyPcpMaQW_90WDRnqapKezhV8HAMJsOnbZPA&s" 
                            alt="Shisa Derecha" />
                    </div>
                </div>

                <div class="search-filters">
                    <div class="search-with-stars">
                        <!-- Estrella dorada -->
                        <svg class="search-star" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <linearGradient id="goldStar" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#FFD700;stop-opacity:1" />
                                    <stop offset="50%" style="stop-color:#FFA500;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#FF8C00;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                            <polygon
                                points="50,5 61,40 98,40 69,55 80,90 50,75 20,90 31,55 2,40 39,40"
                                fill="url(#goldStar)"
                                stroke="#B8860B"
                                stroke-width="2"
                            />
                        </svg>

                        <!-- Input de b煤squeda -->
                        <input type="text" id="searchInput" class="search-input" placeholder="Buscar por t铆tulo o autor...">

                        <!-- Estrella roja -->
                        <svg class="search-star" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                            <defs>
                                <linearGradient id="redStar" x1="0%" y1="0%" x2="100%" y2="100%">
                                    <stop offset="0%" style="stop-color:#DC2626;stop-opacity:1" />
                                    <stop offset="100%" style="stop-color:#991B1B;stop-opacity:1" />
                                </linearGradient>
                            </defs>
                            <polygon
                                points="50,5 61,40 98,40 69,55 80,90 50,75 20,90 31,55 2,40 39,40"
                                fill="url(#redStar)"
                                stroke="#7F1D1D"
                                stroke-width="2"
                            />
                        </svg>
                    </div>

                    <label class="filter-label">
                        <input type="checkbox" id="availableFilter" class="filter-checkbox">
                        <span>Solo disponibles</span>
                    </label>
                </div>
        </div>
    </header>

    <main>
        <div class="library-frame">
            <div class="library-inner">
                <div class="library-molding top"></div>
                <!-- Estantes de Libros -->
                <div id="bookshelvesContainer"></div>
                <div class="library-molding bottom"></div>
            </div>
        </main>

    <footer>
        <div class="footer-content">
            <p> BibliotecApp - Tu puerta al conocimiento universal </p>
            <small>漏 <span id="currentYear"></span> Todos los derechos reservados</small>
        </div>
    </footer>

    <!-- Modal para detalles del libro -->
    <div id="bookModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle" class="modal-title"></h2>
                <button id="modalClose" class="modal-close"></button>
            </div>
            <div id="modalInfo" class="modal-info"></div>
            <div id="modalFormats" class="modal-formats"></div>
        </div>
    </div>

    <script>
        // ========================================
        // DATOS DE LIBROS - ACTUALIZADOS
        // ========================================
        const books = [
            // --- Marxismo ---
            { id: 1, title: 'El Capital', author: 'Karl Marx', year: 1867, status: 'available', color: '#8B4513', pdfUrl: 'https://www.marxists.org/archive/marx/works/1867-Capital-Volume-I/' },
            { id: 2, title: 'El Estado y la Revoluci贸n', author: 'Vladimir Lenin', year: 1917, status: 'available', color: '#A0522D', pdfUrl: 'https://www.marxists.org/archive/lenin/works/1917-State-Revolution/' },
            { id: 3, title: 'La Historia de la Revoluci贸n Rusa', author: 'Le贸n Trotsky', year: 1930, status: 'available', color: '#CD853F', pdfUrl: 'https://www.marxists.org/archive/trotsky/works/1930-History-Russian-Revolution-V1/' },
            { id: 4, title: 'La Condici贸n de la Clase Obrera en Inglaterra', author: 'Friedrich Engels', year: 1848, status: 'available', color: '#D2691E', pdfUrl: 'https://www.marxists.org/archive/engels/works/1848-Condition-Working-Class-England/' },
            { id: 5, title: 'Gravedad y Gracia', author: 'Simone Weil', year: 1940, status: 'available', color: '#B8860B', pdfUrl: 'https://archive.org/details/GravityGrav00weil' },
            { id: 6, title: 'Los Cuadernos de la Prisi贸n', author: 'Antonio Gramsci', year: 1929, status: 'available', color: '#556B2F', pdfUrl: 'https://www.marxists.org/archive/gramsci/works/1929-Prison-Notebooks/' },
            { id: 7, title: 'La Acumulaci贸n del Capital', author: 'Rosa Luxemburgo', year: 1867, status: 'available', color: '#9932CC', pdfUrl: 'https://www.marxists.org/archive/luxemburg/works/1867-Capital-Volume-I/' },
            { id: 8, title: 'El Pr铆ncipe', author: 'Nicol谩s Maquiavelo', year: 1532, status: 'available', color: '#5F9EA0', pdfUrl: 'https://www.gutenberg.org/files/7405/0-hdr/Principe-Maquavelo.html' },
            { id: 9, title: 'Biograf铆a del Che Guevara', author: 'Che Guevara', year: 1952, status: 'available', color: '#D2691E', pdfUrl: 'https://www.marxists.org/guevara/works/1952-Motorcycle-Diaries/' },
            { id: 10, title: 'Evangelii Gaudium', author: 'Papa Francisco', year: 2013, status: 'available', color: '#B8860B', pdfUrl: 'https://www.vatican.va/content/francesco-apostolico/papa-francisco/encyclicas/quadrages-evangelii-gaudium.html' },
            { id: 11, title: 'Pedro P谩ramo', author: 'lvaro Garc铆a M谩rquez', year: 1967, status: 'available', color: '#CD853F', pdfUrl: 'https://app.pulsar.uba.ar/fetch.php/scholarship/T64701/CienAnosDeSoledadLibroCompleto.pdf' },

            // --- Otras ---
            { id: 12, title: 'La Il铆ada', author: 'Homero', year: -750, status: 'available', color: '#D2691E', pdfUrl: 'https://colegiolospensamientos.cl/wp-content/uploads/2023/09/Octubre-I%C2%B0M-La-Iliada-Homero.pdf' },
            { id: 13, title: '1984', author: 'George Orwell', year: 1949, status: 'available', color: '#B8860B', pdfUrl: 'https://www.philosophia.cl/biblioteca/orwell/1984.pdf' },
            { id: 14, title: 'Crimen y Castigo', author: 'Fi贸dor Dostoyevski', year: 1866, status: 'available', color: '#8FBC8F', pdfUrl: 'https://web.seducoahuila.gob.mx/biblioweb/upload/Fedor%20Dostoievski%20-%20Crimen%20y%20castigo.pdf' },
            { id: 15, title: 'Guerra y Paz', author: 'Le贸n Tolst贸i', year: 1869, status: 'available', color: '#9932CC', pdfUrl: 'https://www.suneo.mx/literatura/subidas/Le%C3%B3n%20Tolstoi%20Guerra%20y%20Paz.pdf' },
            { id: 16, title: 'La Divina Comedia', author: 'Dante Alighieri', year: 1320, status: 'available', color: '#BA55D3', pdfUrl: 'https://web.seducoahuila.gob.mx/biblioweb/upload/Dante%20Alighieri%20Divina%20comedia.pdf' },
            { id: 17, title: 'La Odisea', author: 'Homero', year: -700, status: 'available', color: '#C71585', pdfUrl: 'https://www.cjpb.org.uy/wp-content/uploads/repositorio/serviciosAlAfiliado/librosDigitales/Homero-Odisea.pdf' },
            { id: 18, title: 'Moby Dick', author: 'Herman Melville', year: 1851, status: 'available', color: '#DB7093', pdfUrl: 'https://uberty.org/wp-content/uploads/2015/12/herman-melville-moby-dick.pdf' },
            { id: 19, title: 'Ana Karenina', author: 'Le贸n Tolst贸i', year: 1877, status: 'available', color: '#A0522D', pdfUrl: 'https://www.agr-tc.pt/bibliotecadigital/aetc/download/674/Ana%20Karenina%20-%20Leon%20Tolstoi.pdf' },
            { id: 20, title: 'Fahrenheit 451', author: 'Ray Bradbury', year: 1953, status: 'available', color: '#556B2F', pdfUrl: 'https://lexiconic.net/english/F451.pdf' },
            { id: 21, title: 'Neuromante', author: 'William Gibson', year: 1984, status: 'available', color: '#9932CC', pdfUrl: 'https://dn720006.ca.archive.org/0/items/neuromancer_202209/neuromancer.pdf' },
            { id: 22, title: 'Fundaci贸n', author: 'Isaac Asimov', year: 1951, status: 'available', color: '#C71585', pdfUrl: 'https://www.mercaba.org/SANLUIS/ALiteratura/Literatura%20contempor%C3%A1nea/Asimov,%20Issac/Fundaci%C3%B3n.PDF' },
            { id: 23, title: 'Don Juan Tenorio', author: 'Jos茅 Zorrilla', year: 1844, status: 'available', color: '#D2691E', pdfUrl: 'https://www.suneo.mx/literatura/subidas/Jos%C3%A9%20Zorrilla%20Don%20Juan%20Tenorio.pdf' },
            { id: 24, title: 'Casa de los Esp铆ritus', author: 'Isabel Allende', year: 1982, status: 'available', color: '#8FBC8F', pdfUrl: 'https://www.suneo.mx/literatura/subidas/Isabel%20Allende%20La%20Casa%20de%20los%20Esp%C3%ADritus.pdf' },
            { id: 25, title: 'Rayuela', author: 'Julio Cort谩zar', year: 1963, status: 'available', color: '#CD853F', pdfUrl: 'https://seduc.edomex.gob.mx/sites/seduc.edomex.gob.mx/files/padres_familia/fomento_lectura/Julio%20Cortazar%20-%20Rayuela.pdf' },
            { id: 26, title: 'El Nombre de la Rosa', author: 'Umberto Eco', year: 1980, status: 'available', color: '#556B2F', pdfUrl: 'https://www.suneo.mx/literatura/subidas/Umberto%20Eco%20El%20Nombre%20de%20la%20Rosa.pdf' },
            { id: 27, title: 'Viento en los Sauces', author: 'Kenneth Grahame', year: 1908, status: 'available', color: '#8FBC8F', pdfUrl: 'https://www.cjpb.org.uy/wp-content/uploads/repositorio/serviciosAlAfiliado/librosDigitales/Grahame-Viento-Sauces.pdf' },
            { id: 28, title: 'Siddhartha', author: 'Hermann Hesse', year: 1922, status: 'available', color: '#BA55D3', pdfUrl: 'https://cpcglobal.org/publications/Siddhartha%20by%20Hermann%20Hesse.pdf' },
            { id: 29, title: 'Demi谩n', author: 'Hermann Hesse', year: 1919, status: 'available', color: '#C71585', pdfUrl: 'https://www.holybooks.com/wp-content/uploads/DemianBy-Hermann-Hesse.pdf' },
            { id: 30, title: 'El Lobo Estepario', author: 'Hermann Hesse', year: 1927, status: 'available', color: '#9932CC', pdfUrl: 'https://bibliotecadigital.ilce.edu.mx/Colecciones/ObrasClasicas/_docs/ElLoboEstepario.pdf' },

            // --- Nuevos Agregados (Marxismo, Filosof铆a Occidental, Buddhism) ---
            { id: 31, title: 'El Capital', author: 'Karl Marx', year: 1867, status: 'available', color: '#8B4513', pdfUrl: 'https://www.marxists.org/archive/marx/works/1867-Capital-Volume-I/' },
            { id: 32, title: 'El Estado y la Revoluci贸n', author: 'Vladimir Lenin', year: 1917, status: 'available', color: '#A0522D', pdfUrl: 'https://www.marxists.org/archive/lenin/works/1917-State-Revolution/' },
            { id: 33, title: 'La Condici贸n de la Clase Obrera', author: 'Friedrich Engels', year: 1848, status: 'available', color: '#D2691E', pdfUrl: 'https://www.marxists.org/archive/engels/works/1848-Condition-Working-Class-England/' },
            { id: 34, title: 'Revoluci贸n Tra铆da', author: 'Leon Trotsky', year: 1930, status: 'available', color: '#CD853F', pdfUrl: 'https://www.marxists.org/archive/trotsky/works/1930-History-Russian-Revolution-V1/' },
            { id: 35, title: 'Gravedad y Gracia', author: 'Simone Weil', year: 1940, status: 'available', color: '#B8860B', pdfUrl: 'https://archive.org/details/GravityGrav00weil' },
            { id: 36, title: 'Los Cuadernos de la Prisi贸n', author: 'Antonio Gramsci', year: 1929, status: 'available', color: '#556B2F', pdfUrl: 'https://www.marxists.org/archive/gramsci/works/1929-Prison-Notebooks/' },
            { id: 37, title: 'La Acumulaci贸n del Capital', author: 'Rosa Luxemburgo', year: 1867, status: 'available', color: '#9932CC', pdfUrl: 'https://www.marxists.org/archive/luxemburg/works/1867-Capital-Volume-I/' },
            { id: 38, title: 'El Pr铆ncipe', author: 'Nicol谩s Maquiavelo', year: 1532, status: 'available', color: '#5F9EA0', pdfUrl: 'https://www.gutenberg.org/files/7405/0-hdr/Principe-Maquavelo.html' },

            // --- Religi贸n/Arte ---
            { id: 39, title: 'El Viento en los Sauces', author: 'Kenneth Grahame', year: 1908, status: 'available', color: '#8FBC8F', pdfUrl: 'https://www.cjpb.org.uy/wp-content/uploads/repositorio/serviciosAlAfiliado/librosDigitales/Grahame-Viento-Sauces.pdf' },
            { id: 40, title: 'Siddhartha', author: 'Hermann Hesse', year: 1922, status: 'available', color: '#BA55D3', pdfUrl: 'https://cpcglobal.org/publications/Siddhartha%20by%20Hermann%20Hesse.pdf' },
            { id: 41, title: 'Demi谩n', author: 'Hermann Hesse', year: 1919, status: 'available', color: '#C71585', pdfUrl: 'https://www.holybooks.com/wp-content/uploads/DemianBy-Hermann-Hesse.pdf' },
            { id: 42, title: 'El Lobo Estepario', author: 'Hermann Hesse', year: 1927, status: 'available', color: '#9932CC', pdfUrl: 'https://bibliotecadigital.ilce.edu.mx/Colecciones/ObrasClasicas/_docs/ElLoboEstepario.pdf' },

            // --- Buddhism ---
            { id: 43, title: 'Sutra del Diamante', author: 'Buda', year: -400, status: 'available', color: '#D2691E', pdfUrl: 'https://www.o-vob.com/books/Sutra_del_Diamante.pdf' },
            { id: 44, title: 'Sutra del Coraz贸n', author: 'Buda', year: -500, status: 'available', color: '#556B2F', pdfUrl: 'https://www.o-vob.com/books/Sutra_del_Corazon.pdf' },
            { id: 45, title: 'Las Ense帽anzas de Buda', author: 'Buda', year: -500, status: 'available', color: '#3CB371', pdfUrl: 'https://www.o-vob.com/books/Las_Ensenanzas.pdf' },
            { id: 46, title: 'Sutra de la Perfecta Comprensi贸n', author: 'Vimalakirti', year: 500, status: 'available', color: '#BA55D3', pdfUrl: 'https://www.o-vob.com/books/Vimalakirti_Sutra_Perfecta_Comprension.pdf' },
            { id: 47, title: 'Sutras comentados por Osho', author: 'Osho', year: 2014, status: 'available', color: '#CD853F', pdfUrl: 'https://www.o-vob.com/books/Sutras_Comentados_por_Osho.pdf' }
        ];

        // ========================================
        // VARIABLES GLOBALES
        // ========================================
        let allBooks = [...books];
        let filteredBooks = [...books];

        // ========================================
        // FUNCIONES DE UTILIDAD
        // ========================================
        function getAuthorLastName(author) {
            const parts = author.split(' ');
            return parts[parts.length - 1];
        }

        // ========================================
        // CREAR ELEMENTOS DE LIBROS E INSECTOS
        // ========================================
        function createBug(type) {
            const bug = document.createElement('div');
            if (type === 'butterfly') {
                // Variante de color para mariposas
                const randColor = Math.random();
                let colorClass = '';
                if (randColor > 0.66) {
                    colorClass = 'blue';
                } else if (randColor > 0.33) {
                    colorClass = 'yellow';
                }

                bug.className = `butterfly ${colorClass}`;
                bug.innerHTML = '<div class="butterfly-wing left"></div><div class="butterfly-wing right"></div>';
            } else if (type === 'ladybug') {
                bug.className = 'ladybug-container';
                
                // Alas inferiores
                const wingUL = document.createElement('div');
                wingUL.className = 'ladybug-wing-under left';
                bug.appendChild(wingUL);
                
                const wingUR = document.createElement('div');
                wingUR.className = 'ladybug-wing-under right';
                bug.appendChild(wingUR);

                // Cabeza
                const head = document.createElement('div');
                head.className = 'ladybug-head';
                bug.appendChild(head);

                // Alas rojas superiores (Caparach贸n)
                const shellL = document.createElement('div');
                shellL.className = 'ladybug-shell left';
                const sl1 = document.createElement('div'); sl1.className = 'ladybug-spot-shell ls-1'; shellL.appendChild(sl1);
                const sl2 = document.createElement('div'); sl2.className = 'ladybug-spot-shell ls-2'; shellL.appendChild(sl2);
                bug.appendChild(shellL);

                const shellR = document.createElement('div');
                shellR.className = 'ladybug-shell right';
                const sr1 = document.createElement('div'); sr1.className = 'ladybug-spot-shell ls-3'; shellR.appendChild(sr1);
                const sr2 = document.createElement('div'); sr2.className = 'ladybug-spot-shell ls-4'; shellR.appendChild(sr2);
                bug.appendChild(shellR);
            }
            return bug;
        }

        function createBookElement(book) {
            const bookDiv = document.createElement('button');
            // Clase est谩ndar
            bookDiv.className = 'book';
            bookDiv.style.backgroundColor = book.color;
            bookDiv.title = `${book.title} - ${book.author}`;

            // Lomo del libro
            const spine = document.createElement('div');
            spine.className = 'book-spine';
            bookDiv.appendChild(spine);

            // Textura del libro
            const texture = document.createElement('div');
            texture.className = 'book-texture';
            bookDiv.appendChild(texture);

            // Decoraci贸n del lomo
            const decoration = document.createElement('div');
            decoration.className = 'book-decoration';
            for (let i = 0; i < 3; i++) {
                const line = document.createElement('div');
                line.className = 'book-line';
                decoration.appendChild(line);
            }
            bookDiv.appendChild(decoration);

            // LOGICA DE ETIQUETAS SIN PDF (BORRAR TTULO Y AUTOR)
            // Solo se crea la etiqueta si existe una URL v谩lida
            if (book.pdfUrl && book.pdfUrl.trim() !== '' && book.pdfUrl !== 'undefined') {
                const label = document.createElement('div');
                label.className = 'book-label';
                const labelText = document.createElement('div');
                labelText.className = 'book-label-text';
                labelText.textContent = book.title.slice(0, 10);
                const labelAuthor = document.createElement('div');
                labelAuthor.className = 'book-label-author';
                labelAuthor.textContent = getAuthorLastName(book.author);
                label.appendChild(labelText);
                label.appendChild(labelAuthor);
                bookDiv.appendChild(label);
            }

            // Insectos
            if (book.pdfUrl && book.pdfUrl.trim() !== '' && book.pdfUrl !== 'undefined') {
                const rand = Math.random();
                if (rand > 0.85) {
                    const bug = createBug('butterfly');
                    bookDiv.appendChild(bug);
                } else if (rand > 0.7) {
                    const bug = createBug('ladybug');
                    bookDiv.appendChild(bug);
                }
            }

            // Event listener
            bookDiv.addEventListener('click', () => openBookModal(book));

            return bookDiv;
        }

        function createSpecialBook(title, url, color) {
            const link = document.createElement('a');
            link.href = url;
            link.target = '_blank';
            link.rel = 'noopener noreferrer';
            link.className = 'special-book';
            link.style.backgroundColor = color;
            link.title = title;

            // Textura
            const texture = document.createElement('div');
            texture.className = 'special-book-texture';
            link.appendChild(texture);

            // Decoraci贸n
            const decoration = document.createElement('div');
            decoration.className = 'special-book-decoration';
            for (let i = 0; i < 5; i++) {
                const line = document.createElement('div');
                line.className = 'special-book-line';
                decoration.appendChild(line);
            }
            link.appendChild(decoration);

            // Etiqueta
            const label = document.createElement('div');
            label.className = 'special-book-label';
            label.textContent = title;
            link.appendChild(label);
            
            // Insectos
            const rand = Math.random();
            if (rand > 0.6) {
                 const bug = createBug(rand > 0.8 ? 'butterfly' : 'ladybug');
                 link.appendChild(bug);
            }

            return link;
        }

        function createWalkingLadybug() {
            const container = document.createElement('div');
            container.className = 'ladybug-walking';
            
            // Manchas
            const s1 = document.createElement('div'); s1.className = 'spot lw-s1'; container.appendChild(s1);
            const s2 = document.createElement('div'); s2.className = 'spot lw-s2'; container.appendChild(s2);
            const s3 = document.createElement('div'); s3.className = 'spot lw-s3'; container.appendChild(s3);
            const s4 = document.createElement('div'); s4.className = 'spot lw-s4'; container.appendChild(s4);
            
            // Patas (contenedor animado)
            const legs = document.createElement('div');
            legs.className = 'ladybug-walking-legs';
            container.appendChild(legs);

            const direction = Math.random() > 0.5 ? 1 : -1;
            const startX = direction === 1 ? -10 : 110;
            const endX = direction === 1 ? 110 : -10;
            const duration = 10000 + Math.random() * 5000; // 10-15s
            
            container.style.left = startX + '%';
            container.style.bottom = '5px';
            container.style.transform = `scaleX(${direction})`;

            const animation = container.animate([
                { left: startX + '%' },
                { left: endX + '%' }
            ], {
                duration: duration,
                iterations: Infinity,
                easing: 'linear'
            });

            return container;
        }

        function createBookshelf(books, isFirstShelf, alignLeft) {
            const shelfDiv = document.createElement('div');
            shelfDiv.className = 'bookshelf';

            const shelfBg = document.createElement('div');
            shelfBg.className = 'bookshelf-bg';

            const booksContainer = document.createElement('div');
            booksContainer.className = 'books-container';

            if (alignLeft) {
                booksContainer.classList.add('align-left');
            } else {
                booksContainer.classList.add('align-right');
            }

            // Libros especiales (En la fila superior)
            if (isFirstShelf) {
                const nihongoBook = createSpecialBook(
                    'NihongoApp',
                    'https://kami00dragon.github.io/NihongoApp/index.html',
                    '#8B0000'
                );
                booksContainer.appendChild(nihongoBook);

                const aeternusBook = createSpecialBook(
                    'AeternusApp',
                    'https://kami00dragon.github.io/AeternusApp/',
                    '#5D4037'
                );
                booksContainer.appendChild(aeternusBook);

                const gramaticBook = createSpecialBook(
                    'GramaticApp',
                    'https://kami00dragon.github.io/gramaticapp/#posturas-teoricas',
                    '#424242'
                );
                booksContainer.appendChild(gramaticBook);
            }

            // Libros normales
            books.forEach(book => {
                // Si el libro no tiene URL, agregamos clase especial 'no-label' y estilo simple
                const bookElement = createBookElement(book);
                if (!book.pdfUrl || book.pdfUrl === 'undefined') {
                     bookElement.className = 'book no-label';
                }
                booksContainer.appendChild(bookElement);
            });

            const shelfBoard = document.createElement('div');
            shelfBoard.className = 'shelf-board';
            shelfBg.appendChild(booksContainer);
            shelfBg.appendChild(shelfBoard);
            shelfDiv.appendChild(shelfBg);

            if (Math.random() > 0.7) {
                const ladybug = createWalkingLadybug();
                shelfBg.appendChild(ladybug);
            }

            return shelfDiv;
        }

        function renderLibrary() {
            const container = document.getElementById('bookshelvesContainer');
            container.innerHTML = '';

            if (filteredBooks.length === 0) {
                const noResults = document.createElement('div');
                noResults.className = 'no-results';
                noResults.innerHTML = `
                    <h2>No se encontraron libros</h2>
                    <p>Intente con otra b煤squeda o desactive el filtro</p>
                `;
                container.appendChild(noResults);
                return;
            }

            const totalShelves = 50;
            const baseBooksPerShelf = Math.floor(filteredBooks.length / totalShelves);
            const extraBooks = filteredBooks.length % totalShelves;

            for (let i = 0; i < totalShelves; i++) {
                const booksThisShelf = baseBooksPerShelf + (i < extraBooks ? 1 : 0);
                const startIdx = i * baseBooksPerShelf + Math.min(i, extraBooks);
                const shelfBooks = filteredBooks.slice(startIdx, startIdx + booksThisShelf);
                const shelfElement = createBookshelf(shelfBooks, i === 0, i % 2 === 0);
                container.appendChild(shelfElement);
            }
        }

        // ========================================
        // FILTRAR LIBROS
        // ========================================
        function filterBooks() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const availableOnly = document.getElementById('availableFilter').checked;

            filteredBooks = allBooks.filter(book => {
                const matchesSearch =
                    book.title.toLowerCase().includes(searchTerm) ||
                    book.author.toLowerCase().includes(searchTerm);
                const matchesAvailability = !availableOnly || book.status === 'available';
                return matchesSearch && matchesAvailability;
            });

            renderLibrary();
        }

        // ========================================
        // MODAL
        // ========================================
        function openBookModal(book) {
            const modal = document.getElementById('bookModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalInfo = document.getElementById('modalInfo');
            const modalFormats = document.getElementById('modalFormats');

            modalTitle.textContent = book.title;

            const statusClass = book.status === 'available' ? 'modal-status-available' : 'modal-status-unavailable';
            const statusText = book.status === 'available' ? 'Disponible' : 'No disponible';

            modalInfo.innerHTML = `
                <p><strong>Autor:</strong> ${book.author}</p>
                <p><strong>A帽o:</strong> ${book.year}</p>
                <p><strong>Estado:</strong> <span class="${statusClass}">${statusText}</span></p>
            `;

            if (book.status === 'available' && book.pdfUrl) {
                modalFormats.innerHTML = `
                    <a href="${book.pdfUrl}" target="_blank" rel="noopener noreferrer" class="read-pdf-btn">
                         LEER PDF
                    </a>
                `;
            } else {
                modalFormats.innerHTML = `
                    <div class="no-pdf-message">
                        <p> Este libro a煤n no tiene un enlace directo a PDF disponible</p>
                        <small>Los PDFs se est谩n agregando continuamente</small>
                    </div>
                `;
            }

            modal.classList.add('active');
        }

        function closeBookModal() {
            document.getElementById('bookModal').classList.remove('active');
        }

        // ========================================
        // EVENT LISTENERS
        // ========================================
        document.getElementById('searchInput').addEventListener('input', filterBooks);
        document.getElementById('availableFilter').addEventListener('change', filterBooks);
        document.getElementById('modalClose').addEventListener('click', closeBookModal);

        document.getElementById('bookModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeBookModal();
            }
        });

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeBookModal();
            }
        });

        // =======================================
        // INICIALIZACIN
        // =======================================
        function init() {
            document.getElementById('currentYear').textContent = new Date().getFullYear();
            renderLibrary();
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
